scale_fill_brewer(palette="Greens")+
labs(title="Percentage of customer use credit card",x="", y="")
df <- churn_data %>%
group_by(products_number) %>% # Variable to be transformed
count() %>%
ungroup() %>%
mutate(perc = `n` / sum(`n`)) %>%
arrange(perc) %>%
mutate(labels = scales::percent(perc))
str(df)
ggplot(df, aes(x = "", y = perc, fill = products_number)) +
geom_col(color="black") +
geom_label(aes(label = labels),color = c("white", "white","white","white"),
position = position_stack(vjust = 0.5),
show.legend = FALSE) +
coord_polar(theta = "y")+
labs(title="Percentage of  different products used by customers ",x="", y="")
df <- churn_data %>%
group_by(churn) %>%
count() %>%
ungroup() %>%
mutate(perc = `n` / sum(`n`)) %>%
arrange(perc) %>%
mutate(labels = scales::percent(perc))
str(df)
ggplot(df, aes(x = "", y = perc, fill = churn)) +
geom_col(color="black") +
geom_label(aes(label = labels),color = c("black", "black"),
position = position_stack(vjust = 0.5),
show.legend = FALSE) +
coord_polar(theta = "y")+
scale_fill_brewer(palette="Purples")+
labs(title="Percentage of customer retained",x="", y="")
mean.credit_score = mean(churn_data$credit_score, na.rm = TRUE); #mean of the customer credit scores
str(mean.credit_score)
sd_credit_score = sd(churn_data$credit_score)
str(sd_credit_score)
set.seed(321)
churn_credit_sample = churn_data[ sample(nrow(churn_data),4000), ]
format(mean(churn_credit_sample$credit_score), digits=5)
loadPkg("BSDA")
ztestcredit95 = z.test(churn_credit_sample$credit_score, sigma.x = 96.7) # default conf.level = 0.95
ztestcredit95
ztestcredit99 = z.test(churn_credit_sample$credit_score, sigma.x = 96.7, conf.level=0.99 )
ztestcredit99
ztestcredit50 = z.test(churn_credit_sample$credit_score, sigma.x = 96.7, conf.level=0.50 )
ztestcredit50
ztestcredit95$conf.int
ztestcredit99$conf.int
ztestcredit50$conf.int
loadPkg("BSDA")
ttestcredit95 = t.test(churn_credit_sample$credit_score) # default conf.level = 0.95
ttestcredit95
ttestcredit99 = t.test(churn_credit_sample$credit_score, conf.level=0.99 )
ttestcredit99
ttestcredit50 = t.test(churn_credit_sample$credit_score,  conf.level=0.50 )
ttestcredit50
ttestcredit95$conf.int
ttestcredit99$conf.int
ttestcredit50$conf.int
mean.balance= mean(churn_data$balance, na.rm = TRUE); #mean of the customer account balance
str(mean.balance)
sd_balance = sd(churn_data$balance)
str(sd_balance)
set.seed(321)
churn_balance_sample = churn_data[ sample(nrow(churn_data),4000), ]
format(mean(churn_balance_sample$balance), digits=5)
loadPkg("BSDA")
ztestbalance95 = z.test(churn_balance_sample$balance, sigma.x = 62397.4) # default conf.level = 0.95
ztestbalance95
ztestbalance99 = z.test(churn_balance_sample$balance, sigma.x = 62397.4, conf.level=0.99 )
ztestbalance99
ztestbalance50 = z.test(churn_balance_sample$balance, sigma.x = 62397.4, conf.level=0.50 )
ztestbalance50
ztestbalance95$conf.int
ztestbalance99$conf.int
ztestbalance50$conf.int
loadPkg("BSDA")
ttestbalance95 = t.test(churn_balance_sample$balance) # default conf.level = 0.95
ttestbalance95
ttestbalance99 = t.test(churn_balance_sample$balance, conf.level=0.99 )
ttestbalance99
ttestbalance50 = t.test(churn_balance_sample$balance,  conf.level=0.50 )
ttestbalance50
ttestbalance95$conf.int
ttestbalance99$conf.int
ttestbalance50$conf.int
#Contingency table
contab = table(churn_data$churn, churn_data$gender)
#Chisquare Test of independency
chitests = chisq.test(contab)
chitests
chitests$statistic
chitests$parameter
chitests$p.value
ggplot(data=churn_data,aes(x=gender,fill=churn))+
geom_bar(col="black")+
scale_fill_brewer(palette="Blues") +
labs(title = "Gender vs Churn",x="Gender",y="Chrun")+
theme_minimal()
library(corrplot)
churn_data_to_numeric <- churn_data
churn_data$churn[churn_data$churn== "Churned"]<-1
churn_data$churn[churn_data$churn== "Retained"]<-0
churn_data_to_numeric$churn <- as.numeric(churn_data_to_numeric$churn)
str(churn_data_to_numeric)
churn_data_numeric <- select_if(churn_data_to_numeric, is.numeric)
str(churn_data_numeric)
cors <- cor(churn_data_numeric)
corrplot(cors, method = 'number')
cor_scores <- cor(churn_data_numeric$balance, churn_data_numeric$churn)
cor_scores
balance_test<-t.test(balance~churn,data=churn_data)
balance_test
churn_data[, 10:11][churn_data[, 10:11] == 1] <- 'Churn'
churn_data[, 10:11][churn_data[, 10:11] == 0] <- 'No Churn'
cc_churn <- table(churn_data$churn, churn_data$credit_card)
cc_churn
chitestccchurn <- chisq.test(cc_churn)
chitestccchurn
ggplot(churn_data, aes(fill=churn, y=churn, x=credit_card)) +
geom_bar(position='stack', stat='identity') + theme_minimal() +
labs(x='Credit Card', y='Number of Customers', title='Customer Churn in Customers with and without Credit Cards')  +
scale_fill_manual('Position', values=c('red', 'lightblue'))
library(corrplot)
churn_data_to_numeric <- churn_data
churn_data$churn[churn_data$churn== "Churned"]<-1
churn_data$churn[churn_data$churn== "Retained"]<-0
churn_data_to_numeric$churn <- as.numeric(churn_data_to_numeric$churn)
str(churn_data_to_numeric)
churn_data_numeric <- select_if(churn_data_to_numeric, is.numeric)
str(churn_data_numeric)
cors <- cor(churn_data_numeric)
corrplot(cors, method = 'square')
cs_churn <- table(churn_data$churn, churn_data$credit_score)
cs_churn
cor_scores <- cor(churn_data_numeric$credit_score, churn_data_numeric$churn)
cor_scores
#Contingency table
contable = table(churn_data$country, churn_data$churn)
xkabledply(contable, title="Contingency table for Country (Customer belongs to) vs Churn (0 or 1)")
#Chisquare Test of independency
chitest <- chisq.test(contable)
chitest
chitest$statistic
chitest$parameter
chitest$p.value
### 7290530e7885e0b0a98352236618e34354265333
ggplot(data=churn_data,aes(x=country,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'lightgreen')) +
labs(title = "Customer Churn in Different Countries",x="Country",y="Chrun")+
theme_minimal()
#Contingency table
contab = table(churn_data$churn, churn_data$products_number)
#Chisquare Test of independency
chitests = chisq.test(contab)
chitests
chitests$statistic
chitests$parameter
chitests$p.value
ggplot(data=churn_data,aes(x=products_number,fill=churn))+
geom_bar(col="black")+
scale_fill_manual('Position', values=c('red', 'green')) +
labs(title = "Bank Services vs Churn",x="Bank Services",y="Chrun")+
theme_minimal()
#Contingency table
contab = table(churn_data$churn, churn_data$active_member)
#Chisquare Test of independency
chitests = chisq.test(contab)
chitests
chitests$statistic
chitests$parameter
chitests$p.value
ggplot(data=churn_data,aes(x=active_member,fill=churn))+
geom_bar(col="black")+
scale_fill_manual('Position', values=c('red', 'green')) +
labs(title = "Active Members vs Churn",x="Active Members",y="Chrun")+
theme_minimal()
churn_data[, 10:11][churn_data[, 10:11] == 1] <- 'Churn'
churn_data[, 10:11][churn_data[, 10:11] == 0] <- 'No Churn'
cc_churn <- table(churn_data$churn, churn_data$credit_card)
cc_churn
chitestccchurn <- chisq.test(cc_churn)
chitestccchurn
ggplot(churn_data, aes(fill=churn, y=churn, x=credit_card)) +
geom_bar(position='stack', stat='identity', col="black") + theme_minimal() +
labs(x='Credit Card', y='Number of Customers', title='Customer Churn in Customers with and without Credit Cards')  +
scale_fill_manual('Position', values=c('red', 'lightblue'))
churn_data[, 10:11][churn_data[, 10:11] == 1] <- 'Churn'
churn_data[, 10:11][churn_data[, 10:11] == 0] <- 'No Churn'
cc_churn <- table(churn_data$churn, churn_data$credit_card)
cc_churn
chitestccchurn <- chisq.test(cc_churn)
chitestccchurn
ggplot(churn_data, aes(fill=churn, y=churn, x=credit_card)) +
geom_bar(position='stack', stat='identity') + theme_minimal() +
labs(x='Credit Card', y='Number of Customers', title='Customer Churn in Customers with and without Credit Cards')  +
scale_fill_manual('Position', values=c('red', 'lightblue'))
ggplot(data=churn_data,aes(x=country,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'lightgreen')) +
labs(title = "Customer Churn in Different Countries",x="Country",y="Churn")+
theme_minimal()
churn_data[, 10:11][churn_data[, 10:11] == 1] <- 'Churn'
churn_data[, 10:11][churn_data[, 10:11] == 0] <- 'No Churn'
cc_churn <- table(churn_data$churn, churn_data$credit_card)
cc_churn
chitestccchurn <- chisq.test(cc_churn)
chitestccchurn
ggplot(churn_data, aes(fill=churn, y=churn, x=credit_card)) +
geom_bar(position='stack', stat='identity') + theme_minimal() +
labs(x='Credit Card', y='Number of Customers', title='Customer Churn in Customers with and without Credit Cards')  +
scale_fill_manual('Position', values=c('red', 'lightblue'))+
theme_minimal()
churn_data[, 10:11][churn_data[, 10:11] == 1] <- 'Churn'
churn_data[, 10:11][churn_data[, 10:11] == 0] <- 'No Churn'
cc_churn <- table(churn_data$churn, churn_data$credit_card)
cc_churn
chitestccchurn <- chisq.test(cc_churn)
chitestccchurn
ggplot(churn_data, aes(fill=churn, y=churn, x=credit_card)) +
geom_bar() + theme_minimal() +
labs(x='Credit Card', y='Number of Customers', title='Customer Churn in Customers with and without Credit Cards')  +
scale_fill_manual('Position', values=c('red', 'lightblue'))
churn_data[, 10:11][churn_data[, 10:11] == 1] <- 'Churn'
churn_data[, 10:11][churn_data[, 10:11] == 0] <- 'No Churn'
cc_churn <- table(churn_data$churn, churn_data$credit_card)
cc_churn
chitestccchurn <- chisq.test(cc_churn)
chitestccchurn
ggplot(churn_data, aes(fill=churn, y=churn, x=credit_card)) +
geom_bar(position='stack', stat='identity') + theme_minimal() +
labs(x='Credit Card', y='Number of Customers', title='Customer Churn in Customers with and without Credit Cards')  +
scale_fill_manual('Position', values=c('red', 'lightblue'))
ggplot(data=churn_data,aes(x=credit_card,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'lightgreen')) +
labs(title = "Customer Churn in Different Countries",x="Country",y="Churn")+
theme_minimal()
churn_data[, 10:11][churn_data[, 10:11] == 1] <- 'Churn'
churn_data[, 10:11][churn_data[, 10:11] == 0] <- 'No Churn'
cc_churn <- table(churn_data$churn, churn_data$credit_card)
cc_churn
chitestccchurn <- chisq.test(cc_churn)
chitestccchurn
ggplot(churn_data, aes(fill=churn, y=churn, x=credit_card)) +
geom_bar(position='stack', stat='identity') + theme_minimal() +
labs(x='Credit Card', y='Number of Customers', title='Customer Churn in Customers with and without Credit Cards')  +
scale_fill_manual('Position', values=c('red', 'lightblue'))
ggplot(data=churn_data,aes(x=credit_card,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'lightblue')) +
labs(title = "Customer Churn in Different Countries",x="Country",y="Churn")+
theme_minimal()
churn_data[, 10:11][churn_data[, 10:11] == 1] <- 'Churn'
churn_data[, 10:11][churn_data[, 10:11] == 0] <- 'No Churn'
cc_churn <- table(churn_data$churn, churn_data$credit_card)
cc_churn
chitestccchurn <- chisq.test(cc_churn)
chitestccchurn
ggplot(data=churn_data,aes(x=credit_card,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'lightblue')) +
labs(title = "Customer Churn in Different Countries",x="Country",y="Churn")+
theme_minimal()
churn_data[, 10:11][churn_data[, 10:11] == 1] <- 'Churn'
churn_data[, 10:11][churn_data[, 10:11] == 0] <- 'No Churn'
cc_churn <- table(churn_data$churn, churn_data$credit_card)
cc_churn
chitestccchurn <- chisq.test(cc_churn)
chitestccchurn
ggplot(churn_data, aes(fill=churn, y=churn, x=credit_card)) +
geom_bar(position='stack', stat='identity') + theme_minimal() +
labs(x='Credit Card', y='Number of Customers', title='Customer Churn in Customers with and without Credit Cards')  +
scale_fill_manual('Position', values=c('red', 'lightblue'))
ggplot(data=churn_data,aes(x=credit_card,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'lightblue')) +
labs(title = "Customer Churn in Customers With and Without Credi Cards",x="Credit Card",y="Churn")+
theme_minimal()
churn_data[, 10:11][churn_data[, 10:11] == 1] <- 'Churn'
churn_data[, 10:11][churn_data[, 10:11] == 0] <- 'No Churn'
cc_churn <- table(churn_data$churn, churn_data$credit_card)
cc_churn
chitestccchurn <- chisq.test(cc_churn)
chitestccchurn
ggplot(churn_data, aes(fill=churn, y=churn, x=credit_card)) +
geom_bar(position='stack', stat='identity') + theme_minimal() +
labs(x='Credit Card', y='Number of Customers', title='Customer Churn in Customers with and without Credit Cards')  +
scale_fill_manual('Position', values=c('red', 'lightblue'))
ggplot(data=churn_data,aes(x=credit_card,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'lightblue')) +
labs(title = "Customer Churn in Customers With and Without Credit Cards",x="Credit Card",y="Churn")+
theme_minimal()
churn_data[, 10:11][churn_data[, 10:11] == 1] <- 'Churn'
churn_data[, 10:11][churn_data[, 10:11] == 0] <- 'No Churn'
cc_churn <- table(churn_data$churn, churn_data$credit_card)
cc_churn
chitestccchurn <- chisq.test(cc_churn)
chitestccchurn
ggplot(data=churn_data,aes(x=credit_card,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'lightblue')) +
labs(title = "Customer Churn in Customers With and Without Credit Cards",x="Credit Card",y="Churn")+
theme_minimal()
ggplot(data=churn_data,aes(x=products_number,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'lightorange')) +
labs(title = "Bank Services vs Churn",x="Bank Services",y="Chrun")+
theme_minimal()
ggplot(data=churn_data,aes(x=products_number,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'lightyellow')) +
labs(title = "Bank Services vs Churn",x="Bank Services",y="Chrun")+
theme_minimal()
ggplot(data=churn_data,aes(x=products_number,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'purple')) +
labs(title = "Bank Services vs Churn",x="Bank Services",y="Chrun")+
theme_minimal()
ggplot(data=churn_data,aes(x=products_number,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'lavender')) +
labs(title = "Bank Services vs Churn",x="Bank Services",y="Chrun")+
theme_minimal()
ggplot(data=churn_data,aes(x=country,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'peach')) +
labs(title = "Customer Churn in Different Countries",x="Country",y="Churn")+
theme_minimal()
ggplot(data=churn_data,aes(x=country,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'teal')) +
labs(title = "Customer Churn in Different Countries",x="Country",y="Churn")+
theme_minimal()
ggplot(data=churn_data,aes(x=country,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'periwinkle')) +
labs(title = "Customer Churn in Different Countries",x="Country",y="Churn")+
theme_minimal()
ggplot(data=churn_data,aes(x=country,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'cadetblue2')) +
labs(title = "Customer Churn in Different Countries",x="Country",y="Churn")+
theme_minimal()
ggplot(data=churn_data,aes(x=country,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'lavenderblush2')) +
labs(title = "Customer Churn in Different Countries",x="Country",y="Churn")+
theme_minimal()
ggplot(data=churn_data,aes(x=active_member,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'pink1')) +
labs(title = "Active Members vs Churn",x="Active Members",y="Chrun")+
theme_minimal()
ggplot(data=churn_data,aes(x=active_member,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'pink1')) +
labs(title = "Active Members vs Churn",x="Active Status of Account Holders",y="Churn")+
theme_minimal()
churn_data<-data.frame(read.csv("Bank_Customer_Churn_Prediction.csv",header=TRUE))
str(churn_data)
nrow(unique(churn_data))
summary(churn_data)
churn_data <- churn_data[-c(1)]
ncol(churn_data)
summary(churn_data)
str(churn_data)
churn_data_category=churn_data
churn_data_category$credit_card=factor(churn_data$credit_card)
churn_data_category$active_member=factor(churn_data$active_member)
churn_data_category$churn=factor(churn_data$churn)
churn_data_category$gender=factor(churn_data$gender)
churn_data_category$tenure =factor(churn_data$tenure )
churn_data_category$products_number=factor(churn_data$products_number)
str(churn_data_category)
sum(is.na(churn_data) == 'TRUE')
churn_data$active_member[churn_data$active_member== 1]<-"Active"
churn_data$active_member[churn_data$active_member== 0]<-"In Active"
churn_data$credit_card[churn_data$credit_card== 1]<-"Credit Card"
churn_data$credit_card[churn_data$credit_card== 0]<-"No-Credit Card"
churn_data$churn[churn_data$churn== 1]<-"Churned"
churn_data$churn[churn_data$churn== 0]<-"Retained"
credit_score_clean <- outlierKD2(churn_data, credit_score, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
age_clean <- outlierKD2(churn_data, age, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
churn_data$active_member[churn_data$active_member== 1]<-"Active"
churn_data$active_member[churn_data$active_member== 0]<-"In Active"
churn_data$credit_card[churn_data$credit_card== 1]<-"Credit Card"
churn_data$credit_card[churn_data$credit_card== 0]<-"No-Credit Card"
churn_data$churn[churn_data$churn== 1]<-"Churned"
churn_data$churn[churn_data$churn== 0]<-"Retained"
credit_score_clean <- outlierKD2(churn_data, credit_score, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
library(ezids)
loadPkg("Hmisc")
library(dplyr)
loadPkg("MASS")
library(ggplot2)
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3)
credit_score_clean <- outlierKD2(churn_data, credit_score, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
xkablesummary(credit_score_clean)
age_clean <- outlierKD2(churn_data, age, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
xkablesummary(age_clean)
tenure_clean <- outlierKD2(churn_data, tenure, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
xkablesummary(tenure_clean)
balance_clean <- outlierKD2(churn_data, balance, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
xkablesummary(balance_clean)
salary_clean <- outlierKD2(churn_data, estimated_salary, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
xkablesummary(salary_clean)
#Contingency table
contab_productnumber = table(churn_data$churn, churn_data$products_number)
xkabledply(contab_productnumber, title="Contingency table for Banking Services vs Churn (0 or 1)")
#Chisquare Test of independency
chitests = chisq.test(contab_productnumber)
chitests
chitests$statistic
chitests$parameter
chitests$p.value
ggplot(data=churn_data,aes(x=products_number,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'lavender')) +
labs(title = "Bank Services vs Churn",x="Bank Product and Services",y="Chrun")+
theme_minimal()
ggplot(data=churn_data,aes(x=products_number,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'lavender')) +
labs(title = "Bank Product and Services vs Churn",x="Bank Product and Services",y="Chrun")+
theme_minimal()
ggplot(data=churn_data,aes(x=products_number,fill=churn))+
geom_bar()+
scale_fill_manual('Position', values=c('red', 'lavender')) +
labs(title = "Banking Product and Services vs Churn",x="Banking Product and Services",y="Chrun")+
theme_minimal()
#Contingency table
contab = table(churn_data$churn, churn_data$gender)
#Chisquare Test of independency
chitests = chisq.test(contab)
chitests
chitests$statistic
chitests$parameter
chitests$p.value
#Contingency table
contab = table(churn_data$churn, churn_data$gender)
xkabledply(contab, title="Contingency table for Gender(Customer belongs to) vs Churn (0 or 1)")
#Chisquare Test of independency
chitests = chisq.test(contab)
chitests
chitests$statistic
chitests$parameter
chitests$p.value
#Contingency table
contab = table(churn_data$churn, churn_data$gender)
xkabledply(contab, title="Contingency table for Gender(Male, Female) vs Churn (0 or 1)")
#Chisquare Test of independency
chitests = chisq.test(contab)
chitests
chitests$statistic
chitests$parameter
chitests$p.value
#Contingency table
contab_productnumber = table(churn_data$churn, churn_data$products_number)
xkabledply(contab_productnumber, title="Contingency table for Banking Services vs Churn (0 or 1)")
library(ezids)
loadPkg("Hmisc")
library(dplyr)
loadPkg("MASS")
library(ggplot2)
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3)
churn_data<-data.frame(read.csv("Bank_Customer_Churn_Prediction.csv",header=TRUE))
str(churn_data)
nrow(unique(churn_data))
summary(churn_data)
churn_data <- churn_data[-c(1)]
ncol(churn_data)
summary(churn_data)
str(churn_data)
churn_data_category=churn_data
churn_data_category$credit_card=factor(churn_data$credit_card)
churn_data_category$active_member=factor(churn_data$active_member)
churn_data_category$churn=factor(churn_data$churn)
churn_data_category$gender=factor(churn_data$gender)
churn_data_category$tenure =factor(churn_data$tenure )
churn_data_category$products_number=factor(churn_data$products_number)
str(churn_data_category)
sum(is.na(churn_data) == 'TRUE')
churn_data$active_member[churn_data$active_member== 1]<-"Active"
churn_data$active_member[churn_data$active_member== 0]<-"In Active"
churn_data$credit_card[churn_data$credit_card== 1]<-"Credit Card"
churn_data$credit_card[churn_data$credit_card== 0]<-"No-Credit Card"
churn_data$churn[churn_data$churn== 1]<-"Churned"
churn_data$churn[churn_data$churn== 0]<-"Retained"
credit_score_clean <- outlierKD2(churn_data, credit_score, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
xkablesummary(credit_score_clean)
age_clean <- outlierKD2(churn_data, age, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
xkablesummary(age_clean)
tenure_clean <- outlierKD2(churn_data, tenure, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
xkablesummary(tenure_clean)
balance_clean <- outlierKD2(churn_data, balance, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
xkablesummary(balance_clean)
salary_clean <- outlierKD2(churn_data, estimated_salary, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
xkablesummary(salary_clean)
#Contingency table
contab_productnumber = table(churn_data$churn, churn_data$products_number)
xkabledply(contab_productnumber, title="Contingency table for Banking Services vs Churn (0 or 1)")
#Chisquare Test of independency
chitests = chisq.test(contab_productnumber)
chitests
chitests$statistic
chitests$parameter
